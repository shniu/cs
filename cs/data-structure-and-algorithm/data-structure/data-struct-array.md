---
description: '#数组 #数据结构'
---

# Data Struct - Array

掌握数组的核心要素：

1. 数组的实现，如何在内存中表达
2. 在各个主流语言中数组的基本操作和用途
3. 数组的下标为何从 0 开始，而不是 1
4. 数组的特点和复杂度分析
5. 实现 RingBuffer
6. 实现数组动态扩容

数组是一种线性表数据结构，用一组连续的内存空间，来存储一组具有相同数据类型的数据。  
特点：

* 线性表
* 连续的内存空间
* 相同数据类型

有了如上的特点，数组支持随机访问，而且效率很高；但是缺点是：数组的删除、插入需要移动大量的数据。

数组既然支持随机访问，他的实现方式是：在数组创建时，要指定数组的大小，记下数组的访问地址，我们知道数组中数据的类型和大小，在访问某个位置的数据时，就可以用首地址+位置\*数据的size，然后直接进行内存寻址。

**有个容易误解的说法需要澄清：数组适合查找，它的时间复杂度是O\(1\)。**这是有问题的，虽然数组是支持随机访问，时间复杂度是 O\(1\), 但是在数组中查找的时间复杂度也不会是O\(1\)，对于排好序的数组，用二分查找，可以是O\(logn\)，对于无序数组，是O\(n\).

#### 如何解决低效的数组插入和删除操作？

对于数据插入，我们先分析一下时间复杂度，一个有n个元素的数组，要在第k个位置插入数据，时间复杂度分析可知是 O\(n\)；相对来说，这个插入的操作会是“低效”的。当然也有一些办法可以解决：**数组如果是无序的，可以将第k个位置的数据放在数组的最后，把新的数据放在第k个位置，这样就是很高效的操作，这个思想在快排中得到了应用**数组如果是有序的，就只能移动元素了  
对于数据删除，我们分析时间复杂度为 O\(n\)。如果我们不严格追求空间的连续性，我们可以将多个删除操作合并在一起执行，减少数组移动的次数，具体做法是标记数组中哪个数据被删除了，等到没有空间时，我们在一起释放所有被标记删除的数据。**从上面处理的方式上，和JVM的标记清除的算法原理是一致的，标记清除的垃圾回收算法就是将删除的数据先做标记，等到内存不足时，JVM执行垃圾回收，执行数据删除，这样就可以避免频繁的GC，先攒起来，然后在某个合适的时机一起解决。**  
数组越界带来的问题及越界检查访问数组本质上是访问在内存上一片连续的内存空间，只要内存地址是合法的，就可以访问；利用这个漏洞，一些计算机病毒可以来攻击系统，所以一定要注意数组越界问题，特别是 C/C++ 的编程；但是对于一些稍微高级的语言，在语言层面就内置了数组越界检查，当访问的地址超出数组的范围时就抛出异常，比如Java语言。

编程语言中的容器类和数组的关系？**容器类比如Java中的ArraList，C++中的vector等，都是对低层数组的操作细节的封装，提供一个方便使用的可编程接口，以下场景更适合使用数组：**

* **在Java中，ArrayList只能使用包装器类来（int，long），自动装箱和拆箱会有性能损失，所以在非常注重效率的情况下，可以考虑使用数组操作**
* **如果数据大小事先已知，并且操作简单，可以使用数组**
* **多维数组的场景，选用数组更直观**
* **如果是在做业务开发，使用容器更加方便且易操作，虽然有一点点性能损耗，可以首选容器；如果是做底层的网络库开发等，性能要做到极致的场景，就需要优先使用数组了**

  
数组寻址：一维数组寻址，address = base\_address + k \* data\_size二维数组寻址，address = base\_address + \(i \* n + j\) \* data\_size, 二维数组是一个 m \* n 的数组  
数组的下标为何从0开始，而不是1？在寻址时，如果使用1作为下标，在计算某个元素的地址时，就需要多做一次减法运算；另外，C语言是使用0做下标的，然后后续很多编程语言就沿用了。

关于数组的进阶操作：

* 实现一个支持动态扩容的数组（其实这个和ArrayList、Vector等数据结构很相似） ResizableArray
* 实现一个大小固定的有序数组，并支持动态增删改操作
* 实现两个有序数组合并成一个数组
* 实现一个RingBuffer
* 分析 **Java、Golang**、C/C++、Python、Groovy、Rust、Haskell、Kotlin、Javascript 中数组相关的实现

### Array

* 定义及特点

一种线性数据结构，用一组连续的内存空间，来存储一组具有相同数据类型的数据

* 复杂度分析

数组插入 O\(n\) ; 无序数组插入且不考虑前后顺序的可以 O\(1\); 删除 O\(n\); 不考虑顺序的无序数组删除可以 O\(1\); 无序数组查找 O\(n\); 有序数组查找 O\(logn\)

* 操作
* 基本的数组插入、删除、查找、下标索引等
* 实现一个动态有序数组，支持插入、删除、查找等操作
* 实现一个RingBuffer
* 实现一个Resizable Array
* 实现两个有序数组合并为一个
* 常见题目
* 两数之和\#1
* 三数之和\#15
* 删除排序数组中的重复项\#26
* 加一\#66
* 合并两个有序数组\#88
* 旋转数组\#189
* 求众数\#169
* 移动零\#283
* 乘最多水的容器\#11和接雨水问题\#42

