# Tree

### AVL

什么是 AVL 树，解决了什么问题？AVL 树的每个节点的左右子树的高度相差不超过1，是一颗高度平衡的二叉查找树。

发明平衡二叉查找树这类数据结构的初衷是，解决普通二叉查找树在频繁的插入、删除等动态更新的情况下，出现时间复杂度退化的问题AVL 树 wiki：[https://zh.wikipedia.org/wiki/AVL%E6%A0%91](https://zh.wikipedia.org/wiki/AVL%E6%A0%91)

![](../../../.gitbook/assets/image%20%2885%29.png)

AVL 树能够解决二叉查找树在某些情况下性能退化的问题，主要是通过维护每个节点的平衡因子来做到，使用的方式是4种基本的旋转操作：左旋，右旋，左右旋，右左旋。

但是 AVL 也存在一些缺点，在插入或者删除节点时，很容易引起节点的不平衡，所以会频繁的做旋转操作，在一定程度上会降低操作性能；此外，AVL 需要存储额外信息，比如每个节点的平衡因子；总之，维护成本会比较高。

AVL 是一个严格平衡的二叉查找树，然而有些时候我们并不需要那么严格，所以产生了一些近似平衡二叉树，如红黑树等

### 红黑树

红黑树能确保任何一个节点的左右子树高度差小于两倍

1. 节点一类是黑色的，一类是红色的
2. 根节点是黑色的
3. 每个叶子节点都是黑色的空节点，也就是叶子节点不存储数据
4. 任何相邻的节点都不能同时为红色，红色节点是被黑色节点隔开的
5. 每个节点，从该节点到达其可达叶子节点的所有路径，都包含相同数目的黑色节点

红黑树是一个近似平衡的二叉树，根据红黑树的定义分析可知，红黑树的最大高度不会超过 2logn当向红黑树插入节点时可能会破坏红黑树的定义，这个时候就需要调整红黑树以达到平衡特性，主要操作是：左右旋转和颜色改变当在红黑树中删除一个节点同样会破坏红黑树的定义，递归调整以达到平衡Todo： [https://time.geekbang.org/column/article/68976](https://time.geekbang.org/column/article/68976) 红黑树的插入删除深度分析  
红黑树和 AVL 的比较：

1. AVL 比红黑树有更高的查询速度，因为AVL是更严格的平衡
2. 红黑树提供了更加高效的插入和删除操作，因为红黑树的平均旋转操作会更少
3. 红黑树对额外空间的消耗更少，只需要1个bit来存储是黑节点还是红节点，AVL需要一个int类型的数字
4. 红黑树是大部分编程语言实现的基础数据结构，而AVL更多的在数据库中使用；因为红黑树在插入删除多的场景中比较适合，而AVL适合大量读的场景

红黑树的应用场景非常广泛，比如 Linux 的 CPU 任务调度；epoll 的 fd 的维护；nginx 中的 timer 定时器；Java 中 HashMap 的实现

